<!DOCTYPE html>
<html>
<head>
    <title>Test Roles Schema</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto p-4">
        <h1 class="text-2xl font-bold mb-4">Test Roles Schema</h1>
        <div id="results" class="bg-white p-4 rounded shadow"></div>
    </div>

    <script type="module">
        // Import Supabase
        import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm';
        
        // Initialize Supabase
        const supabaseUrl = import.meta.env.VITE_SUPABASE_URL || 'YOUR_SUPABASE_URL';
        const supabaseKey = import.meta.env.VITE_SUPABASE_ANON_KEY || 'YOUR_SUPABASE_KEY';
        const supabase = createClient(supabaseUrl, supabaseKey);
        
        // Test function
        async function testRolesSchema() {
            const results = document.getElementById('results');
            results.innerHTML = '<p>Testing roles schema...</p>';
            
            try {
                // Check if the roles column exists in the users table
                const { data, error } = await supabase
                    .from('users')
                    .select('id, email, role, roles')
                    .limit(1);
                
                if (error) {
                    results.innerHTML = `<p class="text-red-500">Error: ${error.message}</p>`;
                    return;
                }
                
                results.innerHTML = `
                    <h2 class="text-xl font-semibold mb-2">Schema Test Results</h2>
                    <p class="text-green-500">âœ“ Successfully queried users table</p>
                    <p>Sample data structure:</p>
                    <pre class="bg-gray-100 p-2 rounded mt-2">${JSON.stringify(data[0] || 'No data found', null, 2)}</pre>
                `;
            } catch (err) {
                results.innerHTML = `<p class="text-red-500">Error: ${err.message}</p>`;
            }
        }
        
        // Run the test
        testRolesSchema();
    </script>
</body>
</html>